import{g as e,r as a,a as n,q as o,o as i,j as s,b as t,w as l,f as d,F as r,i as c,d as p,t as h,l as u,I as f,u as m,m as x}from"./index-db74daea.js";import{T as g}from"./tabbar.13d69755.js";import{_ as b}from"./_plugin-vue_export-helper.1b428a4d.js";import"./duoxuanAnswer.0b2ac52f.js";import"./uni-app.es.176bdeef.js";import"./components-answerQuestion-calendarSeleteAnswer-calendarSeleteAnswer.af3f5d9d.js";import"./style.0b7734ec.js";const _=""+new URL("edit-a39a3832.png",import.meta.url).href;const E=b({inheritAttrs:!1,components:{TabBar:g},onLoad:function(n){this.tab=n.tab;const o=JSON.parse(e("token"));this.email=o.email,console.log("获取个人信息email:",this.email),a({url:this.$store.state.host+"/getPage",method:"POST",header:{"Content-Type":"application/json",token:e("token")},data:{email:this.email},success:e=>{console.log(e.data),this.name=e.data.data.username,this.phone=e.data.data.phoneNumber,this.currentProvince=e.data.data.location},fail:e=>{},complete:()=>{}})},data:()=>({tab:"",profilePhoto:"/static/home/profilePhoto.png",name:"尘",isExpanded:!1,isInfoExpanded:!1,flag:!1,phone:"13306715109",email:"",provinces:["未知","北京市","天津市","上海市","重庆市","河北省","山西省","辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省","山东省","河南省","湖北省","湖南省","广东省","海南省","四川省","贵州省","云南省","陕西省","甘肃省","青海省","台湾省","内蒙古自治区","广西壮族自治区","西藏自治区","宁夏回族自治区","新疆维吾尔自治区","香港特别行政区","澳门特别行政区"],currentProvince:"未知",origin_phone:"13306715109",origin_provinces:"未知",origin_name:"",token:""}),methods:{expandInput(){this.isInfoExpanded||(this.isExpanded=!0)},confirmInput(n){this.isExpanded&&(this.flag?"name"!=n.target.id&&(this.isExpanded=!1,this.flag=!1,this.origin_name!=this.name&&(this.origin_name,this.name,a({url:this.$store.state.host+"/changename",method:"POST",header:{"Content-Type":"application/json",token:e("token")},data:{username:this.name},success:e=>{console.log(e.data)},fail:()=>{},complete:()=>{}}))):this.flag=!0),this.isInfoExpanded&&(this.flag2?(console.log(n.target.id),n.target.id.startsWith("infoBox")||(this.isInfoExpanded=!1,this.flag2=!1,this.origin_phone==this.phone&&this.origin_provinces==this.currentProvince||(this.origin_phone=this.phone,this.origin_provinces=this.currentProvince,a({url:this.$store.state.host+"/changepl",method:"POST",header:{"Content-Type":"application/json",token:e("token")},data:{phoneNumber:this.phone,location:this.currentProvince},success:e=>{console.log(e.data)},fail:()=>{},complete:()=>{}})))):this.flag2=!0)},expandInfoBox(){this.isExpanded||(this.isInfoExpanded=!0)},onProvinceChange(e){const a=e.detail.value;this.currentProvince=this.provinces[a],"请选择省份"!==this.currentProvince&&(this.trueProvince=this.currentProvince)},goToIndex(){this.isInfoExpanded||this.isExpanded||n({url:"/pages/index/index?flag=true"})},selectImage(){o({count:1,success:e=>{const a=e.tempFilePaths;a&&a.length>0&&(this.profilePhoto=a[0])},fail:e=>{console.error(e)}})}}},[["render",function(e,a,n,o,g,b){const E=c,I=u,k=f,v=m,P=x("tab-bar");return i(),s(r,null,[t(E,{class:d(["background",{"background-blur":g.isExpanded,blur2:g.isInfoExpanded}]),onClick:a[3]||(a[3]=e=>b.confirmInput(e))},{default:l((()=>[t(E,{class:"title"},{default:l((()=>[p(" 我的 ")])),_:1}),t(E,{class:"img",onClick:b.selectImage},{default:l((()=>[t(I,{src:g.profilePhoto,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"]),t(k,{type:"text",id:"name",class:d({name:!0,expanded:g.isExpanded}),modelValue:g.name,"onUpdate:modelValue":a[0]||(a[0]=e=>g.name=e),onClick:b.expandInput,disabled:!g.isExpanded},null,8,["class","modelValue","onClick","disabled"]),t(E,{id:"infoBox",class:d({infoBox:!0,infoExpanded:g.isInfoExpanded})},{default:l((()=>[t(E,{class:"info",id:"infoBox2"},{default:l((()=>[t(E,{class:"item",id:"infoBox3"},{default:l((()=>[t(E,{class:"label",id:"infoBox4"},{default:l((()=>[p("手机：")])),_:1}),t(k,{type:"text",modelValue:g.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>g.phone=e),class:"value",id:"infoBox5",disabled:!g.isInfoExpanded},null,8,["modelValue","disabled"])])),_:1}),t(E,{class:"item",id:"infoBox6"},{default:l((()=>[t(E,{class:"label",id:"infoBox7"},{default:l((()=>[p("邮箱：")])),_:1}),t(k,{type:"text",modelValue:g.email,"onUpdate:modelValue":a[2]||(a[2]=e=>g.email=e),class:"value",id:"infoBox8",disabled:!g.isInfoExpanded},null,8,["modelValue","disabled"])])),_:1}),t(E,{class:"item",id:"infoBox9"},{default:l((()=>[t(E,{class:"label",id:"infoBox10"},{default:l((()=>[p("地区：")])),_:1}),t(v,{mode:"selector",range:g.provinces,onChange:b.onProvinceChange,class:"picker",id:"infoBox11",disabled:!g.isInfoExpanded},{default:l((()=>[t(E,{class:"picker-text",id:"infoBox12"},{default:l((()=>[p(h(g.currentProvince),1)])),_:1})])),_:1},8,["range","onChange","disabled"])])),_:1})])),_:1}),t(I,{class:"icon",src:_,mode:"aspectFit",onClick:b.expandInfoBox},null,8,["onClick"])])),_:1},8,["class"]),t(E,{class:"button",onClick:b.goToIndex},{default:l((()=>[p(" 切换账号 ")])),_:1},8,["onClick"])])),_:1},8,["class"]),t(E,{class:"tabbar",onClick:a[4]||(a[4]=e=>b.confirmInput(e))},{default:l((()=>[t(P,{tab:g.tab,isExpanded:g.isExpanded||g.isInfoExpanded},null,8,["tab","isExpanded"])])),_:1})],64)}],["__scopeId","data-v-5bc976df"]]);export{E as default};
